import{d as F,r as m,S as E,x as $,U as z,K as A,M as P,O as G,V as K,f as S,N as R,o as y,h as O,i as v,R as U,u as j,g as L,y as T,z as p,c as W,a,A as _,b as D,W as X,e as V,m as B,j as H,v as J,l as Q,k as Y,X as Z,p as ee,q as ae,_ as te}from"./index-bPghA7Lr.js";import{D as oe}from"./DialogComponent-QPLja5yR.js";import{h as se}from"./firestore-WiXlrVZ-.js";const N=n=>(ee("data-v-b25116e2"),n=n(),ae(),n),re=N(()=>a("h2",null,"Start playing!",-1)),ne={key:0,class:"game-info-container"},ie={class:"input-container"},ce=N(()=>a("label",{for:"card-name"},"Name your bingo card",-1)),le={key:0,class:"input-description error"},de=N(()=>a("p",{class:"input-description"}," This is used to identify your bingo card in the future. If you decide to take a break you can always come back and find your card again 👍 ",-1)),ue=F({__name:"PlayNewView",setup(n){const h=U(),i=j(),w=L(),g=h.params.gameId;let t;typeof g=="string"?t=g:t=g[0];const M=m("700px"),b=m(!0),s=m(""),c=m(!1);let e,l,f;E(async()=>{h.query.title&&(s.value=h.query.title);const r=$(T,"games",t);if(e=(await z(r)).data(),e&&e.gridWidth){const o=A(G(T,"entries"),P("gameId","==",t));if(l=await K(o),f=e.gridWidth**2-(e.hasFreeSpace?1:0),f<l.size)b.value=!1;else return I()}else return x()});const x=()=>{i.push("/"),w.emit(S(R.ERROR,`The bingo game you are trying to play does not exist (anymore) 😭.
      Make sure you have the correct link or contact the creator of the game!`,1e4))},I=()=>{i.push("/game/"+t),w.emit(S(R.WARNING,`This bingo game is not ready yet 😭.
      If you are the creator or administrator of this game, please add more possible field values!`,1e4))},k=async()=>{if(c.value=s.value.length<3,c.value)return;if(!e)return x();if(!l)return I();const r={gameId:t,title:s.value,gridWidth:e.gridWidth,hasFreeSpace:e.hasFreeSpace,freeSpaceText:e.freeSpaceText,createdAt:new Date().getTime(),entryIds:[]},o=l.docs.map(u=>u.id);for(let u=0;u<f;u++){const C=Math.floor(Math.random()*o.length);r.entryIds.push(o[C]),o.splice(C,1)}const d=await se(r);i.push(`/game/${t}/play/${d}`)},q=()=>{i.push(`/game/${t}`)};return(r,o)=>(y(),O(oe,{open:!b.value,preventClose:!0,maxWidth:M.value},{header:v(()=>[re]),content:v(()=>[p(e)?(y(),W("div",ne,[a("h2",null,_(p(e).name),1),a("p",null,_(p(e).description.substring(0,100))+" "+_(p(e).description.length>100?"...":""),1),a("button",{onClick:q,class:"secondary"},[D(X,{class:"icon",color:"var(--color-primary)"}),V(" More info ")])])):B("",!0),a("div",ie,[ce,H(a("input",{id:"card-name",type:"text",onKeyup:Q(k,["enter"]),"onUpdate:modelValue":o[0]||(o[0]=d=>s.value=d),placeholder:"Colton's Bingo Card",class:Y({error:c.value})},null,34),[[J,s.value]]),c.value?(y(),W("p",le," Damn you lazy like that? 3 characters minimum! ")):B("",!0),de])]),footer:v(()=>[a("button",{class:"primary",onClick:k},[V(" Start "),D(Z,{class:"icon",color:"var(--color-foreground)"})])]),_:1},8,["open","maxWidth"]))}}),ge=te(ue,[["__scopeId","data-v-b25116e2"]]);export{ge as default};
