import{O as m,I as n,y as t,P as y,x as i,F as f,H as d,Q as p,R as l}from"./index-774gC9rx.js";async function q(e){const s=sessionStorage.getItem("pw-exp-very-secure-"+e);if(s){if(parseInt(s)<new Date().getTime())return v(e),!1}else return!1;const a=sessionStorage.getItem("pw-very-secure-"+e);if(!a)return v(e),!1;const r=await D(e,a);return r||v(e),r}function h(e,s){sessionStorage.setItem("pw-very-secure-"+e,s);const a=new Date().getTime()+1e3*60*60*23*1;sessionStorage.setItem("pw-exp-very-secure-"+e,a.toString())}function v(e){sessionStorage.removeItem("pw-exp-very-secure-"+e),sessionStorage.removeItem("pw-very-secure-"+e)}async function x(e,s){const a=await m(n(t,"games"),e);return s.gameId=a.id,await m(n(t,"passwords"),s),a.id}async function C(e){return e.updatedAt=new Date().getTime(),await y(i(t,"games",e.id),e),e}async function G(e,s,a){const r=f(n(t,"passwords"),d("gameId","==",e),d("value","==",s)),o=await p(r);if(o.docs.length===0)return!1;const c=o.docs[0].data();return c.value=a,await y(i(t,"passwords",o.docs[0].id),c),h(e,a),!0}async function P(e){try{await l(i(t,"games",e));const s=f(n(t,"passwords"),d("gameId","==",e)),a=await p(s);for(const w of a.docs.map(u=>u.id))await l(i(t,"passwords",w));v(e);const r=f(n(t,"entries"),d("gameId","==",e)),o=await p(r);for(const w of o.docs.map(u=>u.id))await l(i(t,"entries",w));const c=f(n(t,"cards"),d("gameId","==",e)),g=await p(c);for(const w of g.docs.map(u=>u.id))await l(i(t,"cards",w))}catch(s){return console.error("Error deleting game:",s),!1}return!0}async function D(e,s){const a=f(n(t,"passwords"),d("gameId","==",e)),o=(await p(a)).docs.map(c=>c.data());return o.length===0?(console.log("OH GOD! No password found for game:",e),!1):o[0].value===s}export{G as a,C as b,q as c,P as d,x as e,h as s,D as v};
