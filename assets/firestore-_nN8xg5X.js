import{R as y,K as n,A as a,f as u,N as w,S as C,z as i,H as m,J as d,U as v,V as S,g as E}from"./index-ADHrVkji.js";async function q(e){const s=sessionStorage.getItem("pw-exp-very-secure-"+e);if(s){if(parseInt(s)<new Date().getTime())return g(e),!1}else return!1;const t=sessionStorage.getItem("pw-very-secure-"+e);if(!t)return g(e),!1;const r=await G(e,t);return r||g(e),r}function D(e,s){sessionStorage.setItem("pw-very-secure-"+e,s);const t=new Date().getTime()+1e3*60*60*23*1;sessionStorage.setItem("pw-exp-very-secure-"+e,t.toString())}function g(e){sessionStorage.removeItem("pw-exp-very-secure-"+e),sessionStorage.removeItem("pw-very-secure-"+e)}const f=E();async function N(e,s){const t=await y(n(a,"games"),e);return s.gameId=t.id,await y(n(a,"passwords"),s),f.emit(u(w.SUCCESS,"Game created successfully")),t.id}async function U(e){return e.updatedAt=new Date().getTime(),await C(i(a,"games",e.id),e),f.emit(u(w.SUCCESS,"Game updated successfully")),e}async function x(e,s,t){const r=m(n(a,"passwords"),d("gameId","==",e),d("value","==",s)),o=await v(r);if(o.docs.length===0)return!1;const c=o.docs[0].data();return c.value=t,await C(i(a,"passwords",o.docs[0].id),c),D(e,t),f.emit(u(w.SUCCESS,"Password updated successfully")),!0}async function O(e){try{await S(i(a,"games",e));const s=m(n(a,"passwords"),d("gameId","==",e)),t=await v(s);for(const l of t.docs.map(p=>p.id))await S(i(a,"passwords",l));g(e);const r=m(n(a,"entries"),d("gameId","==",e)),o=await v(r);for(const l of o.docs.map(p=>p.id))await S(i(a,"entries",l));const c=m(n(a,"cards"),d("gameId","==",e)),h=await v(c);for(const l of h.docs.map(p=>p.id))await S(i(a,"cards",l))}catch(s){return console.error("Error deleting game:",s),f.emit(u(w.ERROR,"Error deleting game")),!1}return f.emit(u(w.SUCCESS,"Game deleted successfully")),!0}async function G(e,s){const t=m(n(a,"passwords"),d("gameId","==",e)),o=(await v(t)).docs.map(c=>c.data());return o.length===0?(console.log("OH GOD! No password found for game:",e),f.emit(u(w.ERROR,"Error validating password")),!1):o[0].value===s}export{x as a,U as b,q as c,O as d,N as e,D as s,G as v};
