import{d as R,i as u,b as m,e,n as F,C as x,h as E,r as I,O as j,k as Z,w as C,u as d,H as M,E as z,_ as H,a as ee,f as y,F as te,j as oe,m as ae,g as V,p as b,N as D,X as se,t as q,v as U,s as X,S as ne,U as O,R as re,l as ie}from"./index-MK17qOwK.js";import{D as ce}from"./DialogComponent-Arjzrc6M.js";import{f as J,j as Y}from"./firestore-Hdzc8DpJ.js";import{u as G}from"./index-J6AcmGdw.js";import{G as le}from"./GameInfo-GMubaEwb.js";import{D as de,_ as ue}from"./DeleteConfirmationDialog-IqSugCNe.js";const fe="/field-marker.png",pe={viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},he=R({__name:"IconShare",props:{color:{type:String,default:"#fff"}},setup(n){return(l,g)=>(u(),m("svg",pe,[e("path",{style:F({stroke:n.color}),id:"Vector",d:"M9 6L12 3M12 3L15 6M12 3V13M7.00023 10C6.06835 10 5.60241 10 5.23486 10.1522C4.74481 10.3552 4.35523 10.7448 4.15224 11.2349C4 11.6024 4 12.0681 4 13V17.8C4 18.9201 4 19.4798 4.21799 19.9076C4.40973 20.2839 4.71547 20.5905 5.0918 20.7822C5.5192 21 6.07899 21 7.19691 21H16.8036C17.9215 21 18.4805 21 18.9079 20.7822C19.2842 20.5905 19.5905 20.2839 19.7822 19.9076C20 19.4802 20 18.921 20 17.8031V13C20 12.0681 19.9999 11.6024 19.8477 11.2349C19.6447 10.7448 19.2554 10.3552 18.7654 10.1522C18.3978 10 17.9319 10 17 10","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,4)]))}}),me={key:2},ge=R({__name:"SquareText",props:{entryId:{},isFree:{type:Boolean}},setup(n){const g=x(E,"entries",n.entryId),f=G(g,void 0,{autoDispose:!1}),t=I(null),c=I(null),p=I(2),_=i=>{const k=i.parentElement;return i.offsetWidth>k.offsetWidth||i.offsetHeight>k.offsetHeight-10},h=()=>{(t.value||c.value)&&_(t.value??c.value)&&(p.value-=.1,setTimeout(h,30))};return j([f,t,c],()=>{h()}),(i,k)=>(u(),Z(z,{name:"fade"},{default:C(()=>[d(f)&&!i.isFree?(u(),m("p",{key:0,ref_key:"pRef",ref:t,style:F({fontSize:`${p.value}rem`,"word-break":d(f).value.split(" ").map(v=>v.length>6).some(v=>v)?"break-word":"normal"})},M(d(f).value),5)):i.isFree?(u(),m("p",{key:1,ref_key:"pFreeRef",ref:c,style:F({fontSize:`${p.value}rem`})},M(i.entryId),5)):(u(),m("p",me,"..."))]),_:1}))}}),_e=H(ge,[["__scopeId","data-v-53fc845f"]]),ye=e("path",{d:"M960 0v112.941c467.125 0 847.059 379.934 847.059 847.059 0 467.125-379.934 847.059-847.059 847.059-467.125 0-847.059-379.934-847.059-847.059 0-267.106 126.607-515.915 338.824-675.727v393.374h112.94V112.941H0v112.941h342.89C127.058 407.38 0 674.711 0 960c0 529.355 430.645 960 960 960s960-430.645 960-960S1489.355 0 960 0","fill-rule":"evenodd"},null,-1),ve=[ye],Ie=R({__name:"IconReset",props:{color:{type:String,default:"#fff"}},setup(n){return(l,g)=>(u(),m("svg",{style:F({fill:n.color}),viewBox:"0 0 1920 1920",xmlns:"http://www.w3.org/2000/svg"},ve,4))}}),T=n=>(q("data-v-0c246392"),n=n(),U(),n),ke={key:0,class:"container"},we={class:"header"},Ce={class:"card-title"},Se={class:"flexy-boi"},be=["onClick"],De={key:0,class:"field-marker",src:fe,alt:"field marker"},xe={class:"sidebar"},Ee={class:"info-container"},Fe=T(()=>e("p",{class:"section-heading"},"You are currently playing:",-1)),Re={class:"info-container"},Te=T(()=>e("p",{class:"section-heading"},"Danger zone:",-1)),$e=T(()=>e("p",null," Are you sure you want to delete this bingo card? It will be gone forever and you will not be able to recover it. ",-1)),Ne={key:0,class:"info-container",id:"bingo-teller"},Be=T(()=>e("div",{id:"emoji-container"},[e("h1",null,"ðŸŽ‰"),e("h1",null,"ðŸ¥³"),e("h1",null,"ðŸŽ‰")],-1)),We=T(()=>e("p",null," You can start playing a new card or reset this one by clicking the button in the top right of this section. ",-1)),Ae=R({__name:"TheActualGame",props:{cardId:{},gameId:{}},setup(n){const l=n,g=X(),f=x(E,"cards",l.cardId),t=G(f,void 0,{autoDispose:!1}),c=x(E,"games",l.gameId),p=G(c,void 0,{autoDispose:!1}),_=ee(()=>{if(t.value)if(t.value.hasFreeSpace){const s=Math.floor(t.value.entryIds.length/2),o=[...t.value.entryIds];return o.splice(s,0,t.value.freeSpaceText??"FREE"),o}else return t.value.entryIds;else return[]}),h=I(!1),i=I(!1),k=()=>i.value=!0,v=()=>i.value=!1,N=()=>{navigator.clipboard.writeText(window.location.href),g.emit(b(D.INFO,"The link to this bingo card has been copied to your clipboard."))},B=s=>{if(t.value){const o=[...t.value.chckedEntryIds],r=o.indexOf(s);r>-1?o.splice(r,1):o.push(s),Y({...t.value,id:l.cardId,chckedEntryIds:o})}},W=async()=>{t.value&&Y({...t.value,id:l.cardId,chckedEntryIds:[]})},A=async()=>{await J(l.cardId)&&se.push(`/game/${l.gameId}`)};return j([_,t],([s,o])=>{if(s&&o){const r=()=>{h.value||(g.emit(b(D.SUCCESS,"ðŸŽ‰ðŸ¥³ðŸŽ‰ Congratulations! You got a bingo! ðŸŽ‰ðŸ¥³ðŸŽ‰")),h.value=!0)};for(let a=0;a<o.gridWidth;a++)if(s.slice(a*o.gridWidth,(a+1)*o.gridWidth).every(S=>o.chckedEntryIds.includes(S)))return r();for(let a=0;a<o.gridWidth;a++)if(s.filter((S,$)=>$%o.gridWidth===a).every(S=>o.chckedEntryIds.includes(S)))return r();if(s.filter((a,w)=>w%(o.gridWidth+1)===0).every(a=>o.chckedEntryIds.includes(a))||s.filter((a,w)=>w%(o.gridWidth-1)===0).slice(1,-1).every(a=>o.chckedEntryIds.includes(a)))return r();h.value=!1}}),(s,o)=>d(t)&&d(p)?(u(),m("div",ke,[e("div",we,[e("h1",Ce,M(d(t).title),1),e("button",{class:"share secondary",onClick:N},[y(he,{class:"icon",color:"var(--color-foreground)"})])]),e("div",Se,[e("div",{class:"grid",style:F({gridTemplateColumns:`repeat(${d(p).gridWidth}, 1fr)`})},[(u(!0),m(te,null,oe(_.value,r=>(u(),m("div",{key:r,class:"square"},[e("button",{onClick:()=>B(r)},[y(_e,{entryId:r,isFree:r===d(t).freeSpaceText},null,8,["entryId","isFree"]),y(z,{name:"fade"},{default:C(()=>[d(t).chckedEntryIds.includes(r)?(u(),m("img",De)):V("",!0)]),_:2},1024)],8,be)]))),128))],4),e("div",xe,[e("div",Ee,[Fe,y(le,{game:d(p),gameId:s.gameId,maxDescriptionLength:300},null,8,["game","gameId"])]),e("div",Re,[Te,e("div",null,[y(de,{open:i.value,onClose:v,onDenied:v,onApproved:A},{content:C(()=>[$e]),_:1},8,["open"]),e("button",{onClick:k,class:"primary remove",style:{margin:"0 auto"}},[y(ue,{class:"icon",color:"var(--color-foreground)"}),ae(" Delete my bingo card ")])])]),y(z,{name:"fade"},{default:C(()=>[h.value?(u(),m("div",Ne,[e("p",{style:F({fontSize:"var(--font-size-huge)"})},"You got a bingo!",4),Be,We,e("button",{class:"secondary",onClick:W},[y(Ie,{class:"icon",color:"#000"})])])):V("",!0)]),_:1})])])])):V("",!0)}}),Ve=H(Ae,[["__scopeId","data-v-0c246392"]]),K=n=>(q("data-v-e7ddec91"),n=n(),U(),n),Oe=K(()=>e("h2",null,"Sorry buddy...",-1)),Me=K(()=>e("p",{class:"content-text"}," The bingo card you are trying to play is outdated ðŸ˜­. Do you want to delete this card create a new one? ",-1)),ze=R({__name:"PlayView",setup(n){const l=re(),g=ie(),f=X(),t=l.params.gameId;let c;typeof t=="string"?c=t:c=t[0];const p=l.params.cardId;let _;typeof p=="string"?_=p:_=p[0];const h=I(!1),i=I(!0),k=I(!1);let v="";ne(async()=>{const s=x(E,"games",c),r=(await O(s)).data();if(r&&r.gridWidth){const L=x(E,"cards",_),a=(await O(L)).data();if(a&&a.gameId===c){v=a.title;for(const w of a.entryIds){const S=x(E,"entries",w),$=await O(S);if(!$.exists())h.value=!0;else{const P=$.data();P?P.updatedAt>a.createdAt&&f.emit(b(D.WARNING,`The creator has updated the game, this made some changes to your card.
                  Feel free to delete this bingo card and create a new one if you prefer!`,8e3)):h.value=!0}}i.value=!1}else return B()}else return N()});const N=()=>{g.push("/"),f.emit(b(D.ERROR,`The bingo game you are trying to play does not exist (anymore) ðŸ˜­.
      Make sure you have the correct link or contact the creator of the game!`,1e4))},B=()=>{g.push("/game/"+c),f.emit(b(D.ERROR,`The bingo card you are trying to play does not exist (anymore) ðŸ˜­.
      Do you have the right link?`,1e4))},W=async()=>{await J(_)&&g.push(`/game/${c}/play/new?title=${v}`)},A=()=>{f.emit(b(D.INFO,`You are a real party pooper ðŸ˜¢.
      There is literally no game to play behind the popup.
      I am not letting you close it, enjoy looking at it ðŸ–• !`,1e4))};return(s,o)=>(u(),m("div",null,[y(ce,{open:!i.value&&h.value&&!k.value,"prevent-close":!0},{header:C(()=>[Oe]),content:C(()=>[Me]),footer:C(()=>[e("button",{onClick:A,class:"secondary"}," NO, I HATE FUN "),e("button",{onClick:W,class:"primary"}," YES PLEASE ")]),_:1},8,["open"]),y(Ve,{cardId:d(_),gameId:d(c)},null,8,["cardId","gameId"])]))}}),qe=H(ze,[["__scopeId","data-v-e7ddec91"]]);export{qe as default};
